-- country code for each countries 
UPDATE energy
SET iso_code = CASE 
    WHEN COUNTRY = 'Afghanistan' THEN 'AFG'
    WHEN COUNTRY = 'Albania' THEN 'ALB'
    WHEN COUNTRY = 'Algeria' THEN 'DZA'
    WHEN COUNTRY = 'American Samoa' THEN 'ASM'
    WHEN COUNTRY = 'Andorra' THEN 'AND'
    WHEN COUNTRY = 'Angola' THEN 'AGO'
    WHEN COUNTRY = 'Antigua and Barbuda' THEN 'ATG'
    WHEN COUNTRY = 'Argentina' THEN 'ARG'
    WHEN COUNTRY = 'Armenia' THEN 'ARM'
    WHEN COUNTRY = 'Australia' THEN 'AUS'
    WHEN COUNTRY = 'Austria' THEN 'AUT'
    WHEN COUNTRY = 'Azerbaijan' THEN 'AZE'
    WHEN COUNTRY = 'Bahamas' THEN 'BHS'
    WHEN COUNTRY = 'Bahrain' THEN 'BHR'
    WHEN COUNTRY = 'Bangladesh' THEN 'BGD'
    WHEN COUNTRY = 'Barbados' THEN 'BRB'
    WHEN COUNTRY = 'Belarus' THEN 'BLR'
    WHEN COUNTRY = 'Belgium' THEN 'BEL'
    WHEN COUNTRY = 'Belize' THEN 'BLZ'
    WHEN COUNTRY = 'Benin' THEN 'BEN'
    WHEN COUNTRY = 'Bermuda' THEN 'BMU'
    WHEN COUNTRY = 'Bhutan' THEN 'BTN'
    WHEN COUNTRY = 'Bolivia' THEN 'BOL'
    WHEN COUNTRY = 'Bosnia and Herzegovina' THEN 'BIH'
    WHEN COUNTRY = 'Botswana' THEN 'BWA'
    WHEN COUNTRY = 'Brazil' THEN 'BRA'
    WHEN COUNTRY = 'Brunei' THEN 'BRN'
    WHEN COUNTRY = 'Bulgaria' THEN 'BGR'
    WHEN COUNTRY = 'Burkina Faso' THEN 'BFA'
    WHEN COUNTRY = 'Burundi' THEN 'BDI'
    WHEN COUNTRY = 'Cambodia' THEN 'KHM'
    WHEN COUNTRY = 'Cameroon' THEN 'CMR'
    WHEN COUNTRY = 'Canada' THEN 'CAN'
    WHEN COUNTRY = 'Cape Verde' THEN 'CPV'
    WHEN COUNTRY = 'Central African Republic' THEN 'CAF'
    WHEN COUNTRY = 'Chad' THEN 'TCD'
    WHEN COUNTRY = 'Chile' THEN 'CHL'
    WHEN COUNTRY = 'China' THEN 'CHN'
    WHEN COUNTRY = 'Colombia' THEN 'COL'
    WHEN COUNTRY = 'Comoros' THEN 'COM'
    WHEN COUNTRY = 'Congo' THEN 'COG'
    WHEN COUNTRY = 'Cook Islands' THEN 'COK'
    WHEN COUNTRY = 'Costa Rica' THEN 'CRI'
    WHEN COUNTRY = 'Cote dIvoire' THEN 'CIV'
    WHEN COUNTRY = 'Croatia' THEN 'HRV'
    WHEN COUNTRY = 'Cuba' THEN 'CUB'
    WHEN COUNTRY = 'Cyprus' THEN 'CYP'
    WHEN COUNTRY = 'Czechia' THEN 'CZE'
    WHEN COUNTRY = 'Democratic Republic of Congo' THEN 'COD'
    WHEN COUNTRY = 'Denmark' THEN 'DNK'
    WHEN COUNTRY = 'Djibouti' THEN 'DJI'
    WHEN COUNTRY = 'Dominica' THEN 'DMA'
    WHEN COUNTRY = 'Dominican Republic' THEN 'DOM'
    WHEN COUNTRY = 'East Timor' THEN 'TLS'
    WHEN COUNTRY = 'Ecuador' THEN 'ECU'
    WHEN COUNTRY = 'Egypt' THEN 'EGY'
    WHEN COUNTRY = 'El Salvador' THEN 'SLV'
    WHEN COUNTRY = 'England' THEN 'GBR'
    WHEN COUNTRY = 'Equatorial Guinea' THEN 'GNQ'
    WHEN COUNTRY = 'Eritrea' THEN 'ERI'
    WHEN COUNTRY = 'Estonia' THEN 'EST'
    WHEN COUNTRY = 'Eswatini' THEN 'SWZ'
    WHEN COUNTRY = 'Ethiopia' THEN 'ETH'
    WHEN COUNTRY = 'Fiji' THEN 'FJI'
    WHEN COUNTRY = 'Finland' THEN 'FIN'
    WHEN COUNTRY = 'France' THEN 'FRA'
    WHEN COUNTRY = 'Gabon' THEN 'GAB'
    WHEN COUNTRY = 'Gambia' THEN 'GMB'
    WHEN COUNTRY = 'Georgia' THEN 'GEO'
    WHEN COUNTRY = 'Germany' THEN 'DEU'
    WHEN COUNTRY = 'Ghana' THEN 'GHA'
    WHEN COUNTRY = 'Greece' THEN 'GRC'
    WHEN COUNTRY = 'Greenland' THEN 'GRL'
    WHEN COUNTRY = 'Grenada' THEN 'GRD'
    WHEN COUNTRY = 'Guam' THEN 'GUM'
    WHEN COUNTRY = 'Guatemala' THEN 'GTM'
    WHEN COUNTRY = 'Guinea' THEN 'GIN'
    WHEN COUNTRY = 'GuineaBissau' THEN 'GNB'
    WHEN COUNTRY = 'Guyana' THEN 'GUY'
    WHEN COUNTRY = 'Haiti' THEN 'HTI'
    WHEN COUNTRY = 'Honduras' THEN 'HND'
    WHEN COUNTRY = 'Hungary' THEN 'HUN'
    WHEN COUNTRY = 'Iceland' THEN 'ISL'
    WHEN COUNTRY = 'India' THEN 'IND'
    WHEN COUNTRY = 'Indonesia' THEN 'IDN'
    WHEN COUNTRY = 'Iran' THEN 'IRN'
    WHEN COUNTRY = 'Iraq' THEN 'IRQ'
    WHEN COUNTRY = 'Ireland' THEN 'IRL'
    WHEN COUNTRY = 'Israel' THEN 'ISR'
    WHEN COUNTRY = 'Italy' THEN 'ITA'
    WHEN COUNTRY = 'Jamaica' THEN 'JAM'
    WHEN COUNTRY = 'Japan' THEN 'JPN'
    WHEN COUNTRY = 'Jordan' THEN 'JOR'
    WHEN COUNTRY = 'Kazakhstan' THEN 'KAZ'
    WHEN COUNTRY = 'Kenya' THEN 'KEN'
    WHEN COUNTRY = 'Kiribati' THEN 'KIR'
    WHEN COUNTRY = 'Kuwait' THEN 'KWT'
    WHEN COUNTRY = 'Kyrgyzstan' THEN 'KGZ'
    WHEN COUNTRY = 'Laos' THEN 'LAO'
    WHEN COUNTRY = 'Latvia' THEN 'LVA'
    WHEN COUNTRY = 'Lebanon' THEN 'LBN'
    WHEN COUNTRY = 'Lesotho' THEN 'LSO'
    WHEN COUNTRY = 'Liberia' THEN 'LBR'
    WHEN COUNTRY = 'Libya' THEN 'LBY'
    WHEN COUNTRY = 'Lithuania' THEN 'LTU'
    WHEN COUNTRY = 'Luxembourg' THEN 'LUX'
    WHEN COUNTRY = 'Madagascar' THEN 'MDG'
    WHEN COUNTRY = 'Malawi' THEN 'MWI'
    WHEN COUNTRY = 'Malaysia' THEN 'MYS'
    WHEN COUNTRY = 'Maldives' THEN 'MDV'
    WHEN COUNTRY = 'Mali' THEN 'MLI'
    WHEN COUNTRY = 'Malta' THEN 'MLT'
    WHEN COUNTRY = 'Marshall Islands' THEN 'MHL'
    WHEN COUNTRY = 'Mauritania' THEN 'MRT'
    WHEN COUNTRY = 'Mauritius' THEN 'MUS'
    WHEN COUNTRY = 'Mexico' THEN 'MEX'
    WHEN COUNTRY = 'Micronesia' THEN 'FSM'
    WHEN COUNTRY = 'Moldova' THEN 'MDA'
    WHEN COUNTRY = 'Monaco' THEN 'MCO'
    WHEN COUNTRY = 'Mongolia' THEN 'MNG'
    WHEN COUNTRY = 'Montenegro' THEN 'MNE'
    WHEN COUNTRY = 'Morocco' THEN 'MAR'
    WHEN COUNTRY = 'Mozambique' THEN 'MOZ'
    WHEN COUNTRY = 'Myanmar' THEN 'MMR'
    WHEN COUNTRY = 'Namibia' THEN 'NAM'
    WHEN COUNTRY = 'Nauru' THEN 'NRU'
    WHEN COUNTRY = 'Nepal' THEN 'NPL'
    WHEN COUNTRY = 'Netherlands' THEN 'NLD'
    WHEN COUNTRY = 'New Zealand' THEN 'NZL'
    WHEN COUNTRY = 'Nicaragua' THEN 'NIC'
    WHEN COUNTRY = 'Niger' THEN 'NER'
    WHEN COUNTRY = 'Nigeria' THEN 'NGA'
    WHEN COUNTRY = 'Niue' THEN 'NIU'
    WHEN COUNTRY = 'North Korea' THEN 'PRK'
    WHEN COUNTRY = 'North Macedonia' THEN 'MKD'
    WHEN COUNTRY = 'Northern Ireland' THEN 'NIR'
    WHEN COUNTRY = 'Northern Mariana Islands' THEN 'MNP'
    WHEN COUNTRY = 'Norway' THEN 'NOR'
    WHEN COUNTRY = 'Oman' THEN 'OMN'
    WHEN COUNTRY = 'Pakistan' THEN 'PAK'
    WHEN COUNTRY = 'Palau' THEN 'PLW'
    WHEN COUNTRY = 'Palestine' THEN 'PSE'
    WHEN COUNTRY = 'Panama' THEN 'PAN'
    WHEN COUNTRY = 'Papua New Guinea' THEN 'PNG'
    WHEN COUNTRY = 'Paraguay' THEN 'PRY'
    WHEN COUNTRY = 'Peru' THEN 'PER'
    WHEN COUNTRY = 'Philippines' THEN 'PHL'
    WHEN COUNTRY = 'Poland' THEN 'POL'
    WHEN COUNTRY = 'Portugal' THEN 'PRT'
    WHEN COUNTRY = 'Puerto Rico' THEN 'PRI'
    WHEN COUNTRY = 'Qatar' THEN 'QAT'
    WHEN COUNTRY = 'Romania' THEN 'ROU'
    WHEN COUNTRY = 'Russia' THEN 'RUS'
    WHEN COUNTRY = 'Rwanda' THEN 'RWA'
    WHEN COUNTRY = 'Saint Kitts and Nevis' THEN 'KNA'
    WHEN COUNTRY = 'Saint Lucia' THEN 'LCA'
    WHEN COUNTRY = 'Saint Vincent and the Grenadines' THEN 'VCT'
    WHEN COUNTRY = 'Samoa' THEN 'WSM'
    WHEN COUNTRY = 'San Marino' THEN 'SMR'
    WHEN COUNTRY = 'Sao Tome and Principe' THEN 'STP'
    WHEN COUNTRY = 'Saudi Arabia' THEN 'SAU'
    WHEN COUNTRY = 'Scotland' THEN 'SCO'
    WHEN COUNTRY = 'Senegal' THEN 'SEN'
    WHEN COUNTRY = 'Serbia' THEN 'SRB'
    WHEN COUNTRY = 'Seychelles' THEN 'SYC'
    WHEN COUNTRY = 'Sierra Leone' THEN 'SLE'
    WHEN COUNTRY = 'Singapore' THEN 'SGP'
    WHEN COUNTRY = 'Slovakia' THEN 'SVK'
    WHEN COUNTRY = 'Slovenia' THEN 'SVN'
    WHEN COUNTRY = 'Solomon Islands' THEN 'SLB'
    WHEN COUNTRY = 'Somalia' THEN 'SOM'
    WHEN COUNTRY = 'South Africa' THEN 'ZAF'
    WHEN COUNTRY = 'South Korea' THEN 'KOR'
    WHEN COUNTRY = 'South Sudan' THEN 'SSD'
    WHEN COUNTRY = 'Spain' THEN 'ESP'
    WHEN COUNTRY = 'Sri Lanka' THEN 'LKA'
    WHEN COUNTRY = 'Sudan' THEN 'SDN'
    WHEN COUNTRY = 'Suriname' THEN 'SUR'
    WHEN COUNTRY = 'Sweden' THEN 'SWE'
    WHEN COUNTRY = 'Switzerland' THEN 'CHE'
    WHEN COUNTRY = 'Syria' THEN 'SYR'
    WHEN COUNTRY = 'Taiwan' THEN 'TWN'
    WHEN COUNTRY = 'Tajikistan' THEN 'TJK'
    WHEN COUNTRY = 'Tanzania' THEN 'TZA'
    WHEN COUNTRY = 'Thailand' THEN 'THA'
    WHEN COUNTRY = 'Togo' THEN 'TGO'
    WHEN COUNTRY = 'Tokelau' THEN 'TKL'
    WHEN COUNTRY = 'Tonga' THEN 'TON'
    WHEN COUNTRY = 'Trinidad and Tobago' THEN 'TTO'
    WHEN COUNTRY = 'Tunisia' THEN 'TUN'
    WHEN COUNTRY = 'Turkey' THEN 'TUR'
    WHEN COUNTRY = 'Turkmenistan' THEN 'TKM'
    WHEN COUNTRY = 'Tuvalu' THEN 'TUV'
    WHEN COUNTRY = 'Uganda' THEN 'UGA'
    WHEN COUNTRY = 'Ukraine' THEN 'UKR'
    WHEN COUNTRY = 'United Arab Emirates' THEN 'ARE'
    WHEN COUNTRY = 'United Kingdom' THEN 'GBR'
    WHEN COUNTRY = 'United States' THEN 'USA'
    WHEN COUNTRY = 'United States Virgin Islands' THEN 'VIR'
    WHEN COUNTRY = 'Uruguay' THEN 'URY'
    WHEN COUNTRY = 'Uzbekistan' THEN 'UZB'
    WHEN COUNTRY = 'Vanuatu' THEN 'VUT'
    WHEN COUNTRY = 'Venezuela' THEN 'VEN'
    WHEN COUNTRY = 'Vietnam' THEN 'VNM'
    WHEN COUNTRY = 'Wales' THEN 'WAL'
    WHEN COUNTRY = 'Yemen' THEN 'YEM'
    WHEN COUNTRY = 'Zambia' THEN 'ZMB'
    WHEN COUNTRY = 'Zimbabwe' THEN 'ZWE'
    ELSE 'OTHERS'
END;

-- update the remaining valid country which were not updated with their country code 

UPDATE energy
SET iso_code = CASE 
    WHEN country = 'Burma' THEN 'MMR'
    WHEN country = 'Cabo Verde' THEN 'CPV'
    WHEN country = 'Czech Republic' THEN 'CZE'
    WHEN country = 'Côte d’Ivoire' THEN 'CIV'
    WHEN country = 'Gambia, The' THEN 'GMB'
    WHEN country = 'Timor-Leste' THEN 'TLS'
    WHEN country = 'The Bahamas' THEN 'BHS'
    ELSE iso_code
END;